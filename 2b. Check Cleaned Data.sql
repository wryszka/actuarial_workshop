{"version":"NotebookV1","origId":455928964371021,"name":"2b. Check Cleaned Data","language":"sql","commands":[{"version":"CommandV1","origId":455928964371022,"guid":"0d107f84-0acb-4c71-8857-98c00a8441f2","subtype":"command","commandType":"auto","position":1.0,"command":"%md\nOur cleaned data has been saved as 'claims_data'. Let's do the same basic checks again!","commandVersion":13,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"f40b25ce-a2ee-4cff-96c0-766794f5cbee"},{"version":"CommandV1","origId":455928964371023,"guid":"118c105a-39ef-493b-9bc4-02dfc1b0d4a4","subtype":"command","commandType":"auto","position":1.5,"command":"select count(*) from claims_data","commandVersion":7,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[[185]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"count(*)","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[{"name":"_sqldf","typeStr":"pyspark.sql.connect.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"count(*)","nullable":false,"type":"long"}],"type":"struct"},"tableIdentifier":null}],"columnCustomDisplayInfos":{},"metadata":{"dataframeName":"_sqldf","executionCount":2,"createTempViewForImplicitDf":true}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"_sqldf","typeStr":"pyspark.sql.connect.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"count(*)","nullable":false,"type":"long"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1731590755433,"submitTime":1731590752019,"finishTime":1731590768673,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",1]],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"b0f74848-b3b4-4b7b-bb9b-b1223b5f2596"},{"version":"CommandV1","origId":455928964371024,"guid":"df2cad03-84cd-4480-89f5-c58fa7c94d5a","subtype":"command","commandType":"auto","position":1.75,"command":"%md\nWe expect all our data to be dated from 2020 onwards. Let's see if there are any accident dates before 2020.\n","commandVersion":8,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"729c7402-9a72-4420-8b5f-ab80f07e7508"},{"version":"CommandV1","origId":455928964371025,"guid":"edbfbbe1-013f-407c-a6cf-e3eb265db3f5","subtype":"command","commandType":"auto","position":2.0,"command":"SELECT policy_id, accident_date\nFROM claims_data\nWHERE accident_date < '2020-01-01';","commandVersion":6,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"policy_id","type":"\"long\"","metadata":"{}"},{"name":"accident_date","type":"\"timestamp\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[{"name":"_sqldf","typeStr":"pyspark.sql.connect.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"policy_id","nullable":true,"type":"long"},{"metadata":{},"name":"accident_date","nullable":true,"type":"timestamp"}],"type":"struct"},"tableIdentifier":null}],"columnCustomDisplayInfos":{},"metadata":{"dataframeName":"_sqldf","executionCount":3,"createTempViewForImplicitDf":true}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"_sqldf","typeStr":"pyspark.sql.connect.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"policy_id","nullable":true,"type":"long"},{"metadata":{},"name":"accident_date","nullable":true,"type":"timestamp"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1731590768737,"submitTime":1731590760582,"finishTime":1731590771681,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",0]],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"cc624fd1-eb53-4b44-95ec-218bdfca4199"},{"version":"CommandV1","origId":455928964371026,"guid":"9cdb61f4-d335-40a2-9d88-224da0ae9f2c","subtype":"command","commandType":"auto","position":3.0,"command":"%md\nSome issues!\nLet's now check the claim amount. We don't expect to see more than 100k payout.\n","commandVersion":8,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"bfcfd5e2-5aca-4617-aa63-54f4c61c281c"},{"version":"CommandV1","origId":455928964371027,"guid":"202ba0f4-d43c-4ed1-86dc-48b9b71ed5ea","subtype":"command","commandType":"auto","position":4.0,"command":"SELECT policy_id, cumulative_paid FROM claims_data\nWHERE cumulative_paid > 100000;","commandVersion":10,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"policy_id","type":"\"long\"","metadata":"{}"},{"name":"cumulative_paid","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[{"name":"_sqldf","typeStr":"pyspark.sql.connect.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"policy_id","nullable":true,"type":"long"},{"metadata":{},"name":"cumulative_paid","nullable":true,"type":"long"}],"type":"struct"},"tableIdentifier":null}],"columnCustomDisplayInfos":{},"metadata":{"dataframeName":"_sqldf","executionCount":4,"createTempViewForImplicitDf":true}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"_sqldf","typeStr":"pyspark.sql.connect.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"policy_id","nullable":true,"type":"long"},{"metadata":{},"name":"cumulative_paid","nullable":true,"type":"long"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1731590771728,"submitTime":1731590766769,"finishTime":1731590774998,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",0]],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"cf23cc37-2320-48ad-ac38-68ead1f2cca5"},{"version":"CommandV1","origId":455928964371028,"guid":"a815cf95-334f-44cc-97f7-e0167064212f","subtype":"command","commandType":"auto","position":5.0,"command":"%md\nOK, it seems our data is clean. We can progress!\nPlease move to '3. Triangles'.\n","commandVersion":15,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"dc016ac9-057c-4651-b795-7b4e0a8a7dac"},{"version":"CommandV1","origId":455928964373248,"guid":"d362e451-18c4-4068-a919-146dc2e16bd2","subtype":"command","commandType":"auto","position":1.25,"command":"%python\nuser = spark.sql(\"select current_user()\").collect()[0][0]\ndisplay(user)\ncatalog_name = user.replace(\".\", \"_\").replace(\"@\", \"_\")\ndisplay(catalog_name)\nspark.sql(f\"USE CATALOG {catalog_name}\")\nspark.sql(f\"USE SCHEMA actuarial_demo\")\n","commandVersion":6,"state":"finished","results":{"type":"listResults","data":[{"type":"mimeBundle","data":{"text/plain":"'laurence.ryszka@databricks.com'"},"executionCount":null,"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"kernelSessionId":"ec89daaf-d1e964507062dca5245227d7"}},{"type":"mimeBundle","data":{"text/plain":"'laurence_ryszka_databricks_com'"},"executionCount":null,"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"kernelSessionId":"ec89daaf-d1e964507062dca5245227d7"}},{"type":"mimeBundle","data":{"text/plain":"DataFrame[]"},"executionCount":1,"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"kernelSessionId":"ec89daaf-d1e964507062dca5245227d7"}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1731590748029,"submitTime":1731590741093,"finishTime":1731590755213,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["mimeBundle",null],["mimeBundle",null],["mimeBundle",null]],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"8048db5a-45f9-4054-a1a1-0ef9d157f55b"}],"dashboards":[],"guid":"0635785d-789d-4509-b535-ecb6ac11bb95","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":2},"reposExportFormat":"SOURCE","environmentMetadata":{"client":"1","base_environment":""}}